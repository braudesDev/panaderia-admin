<h2>Registro de Sobrantes</h2>

<div>
  <label>ID del Cliente:</label>
  <input [(ngModel)]="clienteId" placeholder="cliente123" />
</div>

<div>
  <label>Tiras Entregadas:</label>
  <input type="number" [(ngModel)]="entregadas" />
</div>

<div>
  <label>Tiras Sobrantes:</label>
  <input type="number" [(ngModel)]="sobrantes" />
</div>

<button (click)="registrar()">Registrar</button>
<button (click)="sincronizarConFirebase()">📤 Sincronizar con Firebase</button>

<p *ngIf="mensaje" [ngStyle]="{ color: esAlerta ? 'red' : 'green' }">
  {{ mensaje }}
</p>

<hr />

<h3>📋 Historial de registros</h3>

<table *ngIf="historial.length > 0" border="1" cellpadding="5">
  <thead>
    <tr>
      <th>Fecha</th>
      <th>Cliente</th>
      <th>Entregadas</th>
      <th>Sobrantes</th>
      <th>%</th>
      <th>Alerta</th>
      <th>Estado</th>
    </tr>
  </thead>
  <tbody>
    <tr *ngFor="let item of historial">
      <td>{{ item.fecha }}</td>
      <td>{{ item.clienteId }}</td>
      <td>{{ item.entregadas }}</td>
      <td>{{ item.sobrantes }}</td>
      <td>{{ item.porcentaje }}%</td>
      <td [ngStyle]="{ color: item.alerta ? 'red' : 'green' }">
        {{ item.alerta ? '⚠️ Exceso' : '✅ OK' }}
      </td>
      <td [ngStyle]="{ color: item.sincronizado ? 'green' : 'orange' }">
        {{ item.sincronizado ? 'Sincronizado' : 'Pendiente' }}
      </td>
    </tr>
  </tbody>
</table>

<button (click)="verHistorial()">📋 Ver historial de sobrantes</button>
